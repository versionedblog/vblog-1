<!--
  ~ Copyright (c) 2014. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<!DOCTYPE html>
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="lib/marked.js"></script>
    <script>
        $.extend({
          getUrlVars: function(){
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++)
            {
              hash = hashes[i].split('=');
              vars.push(hash[0]);
              vars[hash[0]] = hash[1];
            }
            return vars;
          },
          getUrlVar: function(name){
            return $.getUrlVars()[name];
          }
        });
        $(document).ready(function(){
            //Second call with this:
            // Get object of URL parameters
            var allVars = $.getUrlVars();

            // Getting URL var by its nam
            var messageId = $.getUrlVar('id');
            //var docId = $.url;
            //alert("DocId=" + docId);
            $.get("/rest/json/messagelist/all/user/1/message/" + messageId,function(data,status){

                if(data.previousMessageId == null) {
                    $('#prevMessageLink').hide();
                } else {
                    var prevMessageLink = $("<a></a>").attr("href", "message.html?id="+data.previousMessageId).text("Prev Message");
                    $('#prevMessageLink').show();
                    $('#prevMessageLink').html(prevMessageLink);
                }
                if(data.nextMessageId == null) {
                    $('#nextMessageLink').hide();
                } else {
                    var nextMessageLink = $("<a></a>").attr("href", "message.html?id="+data.nextMessageId).text("Next Message");
                    $('#nextMessageLink').show();
                    $('#nextMessageLink').html(nextMessageLink);
                }

                if(data.previousVersionId == null) {
                    $('#prevVersionLink').hide();
                } else {
                    var prevVersionLink = $("<a></a>").attr("href", "message.html?id="+data.previousVersionId).text("Prev Version");
                    $('#prevVersionLink').show();
                    $('#prevVersionLink').html(prevVersionLink);
                }
                if(data.nextVersionId == null) {
                    $('#nextVersionLink').hide();
                } else {
                    var nextVersionLink = $("<a></a>").attr("href", "message.html?id="+data.nextVersionId).text("Next Version");
                    $('#nextVersionLink').show();
                    $('#nextVersionLink').html(nextVersionLink);
                }

                var title = $( "#title" ).val();
                var author = $( "#author" ).val();
                var content = $( "#text-input" ).val();
                $("#content").html(marked("####" + data.vmessage.title + "\n" + "#### *By:*" + data.vmessage.author + ", " +" *At:*" + new Date(data.vmessage.created) + "\n" +  data.vmessage.content));

                //$('#title').html(data.vmessage.title);
                //$('#content').html(data.vmessage.content);

            });

});




    </script>
</head>
<body>

<table id="thetable">
    <tr>
        <td id="prevMessageLink">Prev Message Link</td>
        <td id="nextMessageLink">Next Message Link</td>
    </tr>
    <tr>
        <td id="prevVersionLink">Prev Version Link</td>
        <td id="nextVersionLink">Next Version Link</td>
    </tr>
    <tr>
        <td id="content" colspan="2"> Content will be here</td>
    </tr>
</table>


</body>
</html>


